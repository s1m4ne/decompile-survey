# 日報: 2026-01-22

## 概要
スクリーニングアプリにローカルLLMサーバー対応機能を追加。Finder経由でのファイル選択、接続確認機能、UI改善を実施。研究メモ用ディレクトリを作成。

---

## 作業ログ

### 午前〜午後 - スクリーニング機能のコミット

#### 実施内容
前日の未コミット分をまとめてコミット：
- スクリーニングシステムの基盤実装
- 非同期スクリーニング（並列実行対応）
- Webアプリケーション（FastAPI + React）
- レビューシステムの簡略化（checkedフィールド削除）
- ルールファイルのリネーム・バージョン管理

#### コミット
- `6708854` Add screening system and unify environment config
- `0831a58` Add async screening with concurrency and decompile rules
- `ae250e9` Add screening web app and v2 rules
- `4144190` Update README with screening directory structure
- `98e6432` Simplify review system: remove checked field and improve UI
- `97b1bf7` Rename rules files and add new rule versions

---

### 夕方 - ローカルLLMサーバー対応

#### 実施内容
VPN経由で接続するローカルLLMサーバー（`192.168.50.100:8000`）をスクリーニングのプロバイダーとして選択可能に：

**バックエンド変更（`screening/app/backend/routers/screening.py`）**
- `ScreeningRequest`に`provider`フィールドを追加
- ローカルサーバー接続確認エンドポイント `GET /api/screening/check-local-server`
  - 接続状態、利用可能モデル一覧、エラーメッセージを返却
  - タイムアウト・接続エラー時はVPN確認を促すメッセージ
- Finderでファイル選択エンドポイント `POST /api/screening/pick-file`
  - AppleScriptで`.bib`ファイル選択ダイアログを表示
  - 絶対パスを返却

**スクリプト変更（`screening/scripts/screen.py`）**
- `--provider`引数を追加（`openai` / `local`）
- ローカルサーバーURL: `http://192.168.50.100:8000/v1`
- ローカル使用時は`api_key="dummy"`でOpenAIクライアント初期化

**フロントエンド変更**
- プロバイダー選択UI（ラジオボタン）
- プロバイダー別モデル選択
  - OpenAI: gpt-4o-mini, gpt-4o, o3-mini
  - Local: openai/gpt-oss-120b（サーバーから取得）
- 接続確認ボタン・ステータス表示
- 並列数のデフォルト値をプロバイダー別に設定
  - OpenAI: 10
  - Local: 500
- Finderからファイル選択ボタン

#### UI改善
- 並列数入力欄のmin/max制限を削除（編集しやすく）
- Finderダイアログが同じデスクトップで開くように修正
  - AppleScriptから`tell application "Finder" activate`を削除

#### コミット
- `2265222` Add local LLM server support and improve screening UI

---

### 夕方 - スクリーニング実行データのコミット

#### 実施内容
スクリーニング実行結果とレビューデータをコミット：
- `screening/runs/2026-01-22_1651/` - 実行結果
- `screening/reviews/2026-01-22_1651/` - レビューデータ

#### コミット
- `2e1da29` Add screening runs and review data

---

### 夕方 - 研究メモディレクトリ作成

#### 実施内容
研究メモを保存するディレクトリを作成：
- `notes/` ディレクトリを新規作成
- `notes/2026-01-22_survey-structure-hybrid-narrative-slr.md` - サーベイ構成案のメモ

---

## 技術メモ

### ローカルLLMサーバー仕様
| 項目 | 値 |
|------|-----|
| URL | `http://192.168.50.100:8000` |
| API | OpenAI互換（vLLM） |
| モデル | `openai/gpt-oss-120b` |
| 接続 | VPN必須 |

### AppleScriptでのファイル選択
```applescript
set theFile to choose file with prompt "BibTeXファイルを選択してください" of type {"bib"}
return POSIX path of theFile
```
- `tell application "Finder" activate`を入れると別デスクトップで開く問題があったため削除

### 並列実行数の目安
| プロバイダー | デフォルト | 備考 |
|-------------|-----------|------|
| OpenAI | 10 | Rate limit考慮 |
| Local | 500 | サーバー性能次第 |

---

## 変更ファイル一覧

### 変更
- `screening/scripts/screen.py` - provider引数追加
- `screening/app/backend/routers/screening.py` - 接続確認・ファイル選択API追加
- `screening/app/frontend/src/lib/api.ts` - 新API型定義追加
- `screening/app/frontend/src/pages/ScreeningPage.tsx` - プロバイダー選択UI

### 新規作成
- `notes/2026-01-22_survey-structure-hybrid-narrative-slr.md`
- `notes/2026-01-22-slr-reference-papers.md`
- `notes/2026-01-23-llm-decompilation-method-taxonomy.md`
- `screening/runs/2026-01-22_1651/`
- `screening/runs/2026-01-22_2326/`
- `screening/runs/2026-01-22_2327/`
- `screening/reviews/2026-01-22_1651/`
- `screening/reviews/2026-01-22_2326/`
- `screening/reviews/2026-01-22_2327/`
- `screening/rules/decompile_v4.md`

---

### 深夜 - スクリーニング追加実行

#### 実施内容
新しいルールファイル（decompile_v4.md）を使ってスクリーニングを再実行：

| Run ID | 入力 | Include | Exclude | Uncertain |
|--------|------|---------|---------|-----------|
| 2026-01-22_2326 | arXiv_decompil (100件) | 29 | 70 | 1 |
| 2026-01-22_2327 | decompile-survey.bib (655件) | 53 | 600 | 2 |

#### 新規作成
- `screening/runs/2026-01-22_2326/` - arXivデータのスクリーニング結果
- `screening/runs/2026-01-22_2327/` - 全データのスクリーニング結果
- `screening/reviews/2026-01-22_2326/` - レビューデータ
- `screening/reviews/2026-01-22_2327/` - レビューデータ
- `screening/rules/decompile_v4.md` - スクリーニングルール v4

---

### 深夜 - 研究メモ追加

#### 実施内容
SLR参考論文のメモとLLMデコンパイル手法の分類メモを作成：

- `notes/2026-01-22-slr-reference-papers.md` - SLRの参考論文リスト
- `notes/2026-01-23-llm-decompilation-method-taxonomy.md` - LLMデコンパイル手法の分類案（9カテゴリ）

#### LLMデコンパイル手法の分類（暫定）
1. そのままLLMに翻訳させる系（prompt主体）
2. 小型LLM・専用LLMを作る系
3. コンテキスト構築・補助情報系
4. 構造（AST/IR）を吐かせる系
5. RAG系
6. Fine-tune系
7. 出力の修復/整形系
8. 再コンパイル可能を目標にする系
9. 対象ドメイン別（EVM/Wasm/DNN）

---

## タグ
`#ローカルLLM` `#vLLM` `#スクリーニング` `#UI改善` `#AppleScript` `#FastAPI` `#React` `#LLMデコンパイル` `#手法分類`
